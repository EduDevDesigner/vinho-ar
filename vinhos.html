<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <title>Vinhos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="style.css">
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

    <style>
      /* ðŸ”¹ BotÃ£o de DescriÃ§Ã£o */
      #btn-desc {
        position: fixed;
        right: 15px;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(0,0,0,0.6);
        color: #fff;
        border: 1px solid #fff;
        padding: 10px 16px;
        border-radius: 6px;
        font-size: 15px;
        cursor: pointer;
        z-index: 9999;
        display: none;
      }

      /* ðŸ”¹ Painel */
      #painel-desc {
        position: fixed;
        right: 0;
        top: 0;
        width: 70%;
        height: 100%;
        background: rgba(0,0,0,0.88);
        color: white;
        padding: 20px;
        z-index: 10000;
        display: none;
      }

      /* ðŸ”¹ BotÃ£o X fechar */
      #fechar-painel {
        position: absolute;
        right: 15px;
        top: 15px;
        font-size: 26px;
        cursor: pointer;
        color: #fff;
      }
    </style>

  </head>
  <body>
    
    <!-- ðŸ”¹ Mensagem de foco no track -->
    <div id="track-message">
      Aponte a cÃ¢mera para o marcador!
    </div>

    <!-- ðŸ”¹ BotÃ£o de descriÃ§Ã£o -->
    <div id="btn-desc">DescriÃ§Ã£o</div>

    <!-- ðŸ”¹ Painel lateral -->
    <div id="painel-desc">
      <div id="fechar-painel">X</div>
      <h2>CaracterÃ­sticas do Vinho</h2>
      <p id="texto-vinho"></p>
    </div>

    <!-- ðŸŽµ Ãudios -->
    <audio id="audio-vinho1" src="Audios/Pinot%20Noir.mp3"></audio>
    <audio id="audio-vinho2" src="Audios/Riesling.mp3"></audio>

    <!-- Cena AR -->
    <a-scene mindar-image="imageTargetSrc: Imagens/targets.mind;" 
             color-space="sRGB" 
             renderer="colorManagement: true, physicallyCorrectLights" 
             xr-mode-ui="enabled: false" 
             device-orientation-permission-ui="enabled: false">

      <a-assets>
        <a-asset-item id="vinho1" src="Modelos/vinho1.glb"></a-asset-item>
        <a-asset-item id="vinho2" src="Modelos/vinho2.glb"></a-asset-item>
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <a-entity mindar-image-target="targetIndex: 0">
        <a-gltf-model rotation="90 0 0 " position="0 0 0" scale="1 1 1" src="#vinho1"></a-gltf-model>
      </a-entity>

      <a-entity mindar-image-target="targetIndex: 1">
        <a-gltf-model rotation="90 0 0 " position="0 0 0" scale="1 1 1" src="#vinho2"></a-gltf-model>
      </a-entity>

    </a-scene>

    <script>
      window.addEventListener("DOMContentLoaded", () => {

        const trackMessage = document.getElementById("track-message");
        const btnDesc = document.getElementById("btn-desc");
        const painel = document.getElementById("painel-desc");
        const fecharPainel = document.getElementById("fechar-painel");
        const textoVinho = document.getElementById("texto-vinho");

        // ðŸŽµ Ãudios
        const audio1 = document.getElementById("audio-vinho1");
        const audio2 = document.getElementById("audio-vinho2");

        let vinhoAtual = null; // guarda qual vinho estÃ¡ ativo

        const targets = document.querySelectorAll("[mindar-image-target]");

        targets.forEach(target => {

          target.addEventListener("targetFound", () => {
            trackMessage.style.display = "none";
            btnDesc.style.display = "block";

            const index = target.getAttribute("mindar-image-target").targetIndex;

            vinhoAtual = index; // salva qual vinho estÃ¡ ativo

            if (index == "0") {
              textoVinho.textContent =
                "O Vinho Marcus James Pinot Noir Ã© leve, possui aromas frutados lembrando morangos, com paladar macio. Ã‰ um vinho jovem e muito agradÃ¡vel.";
            } 
            else if (index == "1") {
              textoVinho.textContent =
                "Vinho 2 â€” Intenso, encorpado, com final longo e persistente.";
            }

          });

          target.addEventListener("targetLost", () => {
            trackMessage.style.display = "block";
            btnDesc.style.display = "none";
            painel.style.display = "none";

            // ðŸŽµ parar Ã¡udio se perder o marcador
            audio1.pause();
            audio2.pause();
            audio1.currentTime = 0;
            audio2.currentTime = 0;
          });

        });

        // Abrir painel + tocar Ã¡udio certo
        btnDesc.addEventListener("click", () => {
          painel.style.display = "block";

          if (vinhoAtual == "0") {
            audio2.pause();
            audio2.currentTime = 0;
            audio1.play();
          }
          if (vinhoAtual == "1") {
            audio1.pause();
            audio1.currentTime = 0;
            audio2.play();
          }
        });

        // Fechar painel + parar Ã¡udio
        fecharPainel.addEventListener("click", () => {
          painel.style.display = "none";
          audio1.pause();
          audio2.pause();
          audio1.currentTime = 0;
          audio2.currentTime = 0;
        });

      });
    </script>

  </body>
</html>
